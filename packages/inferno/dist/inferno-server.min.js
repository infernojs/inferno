!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("stream")):"function"==typeof define&&define.amd?define(["stream"],r):(e.Inferno=e.Inferno||{},e.Inferno.Server=r(e.stream))}(this,function(e){"use strict";function r(e){for(var r=e+"",n=r.length,t="",o=0;o<n;o++)switch(r.charCodeAt(o)){case 38:t+="&amp;";break;case 39:t+="&#039;";break;case 34:t+="&quot;";break;case 60:t+="&lt;";break;case 62:t+="&gt;";break;default:t+=r[o]}return t}function n(e){return e.replace(S,"-$&").toLowerCase().replace(C,"-ms-")}function t(e){return!!I[e]}function o(e){return a(e)||l(e)}function i(e){return p(e)||c(e)}function u(e){return c(e)||e===!1||f(e)||p(e)}function s(e){return"function"==typeof e}function a(e){return"string"==typeof e}function l(e){return"number"==typeof e}function c(e){return null===e}function f(e){return e===!0}function p(e){return void 0===e}function d(e){throw e||(e=_),new Error("Inferno Error: "+e)}function h(e,r,n){e.split(",").forEach(function(e){return r[e]=n})}function m(e,r){for(var n in e)p(r[n])&&(r[n]=e[n])}function v(e){if(o(e))return e;var t="";for(var u in e){var s=e[u],a=l(s)&&!W[u]?"px":"";i(s)||(t+=n(u)+":"+r(s)+a+";")}return t}function y(e,n,a){var l=e.flags,p=e.type,h=e.props,g=e.children;if(28&l){var w=4&l;if(i(p.defaultProps)||(m(p.defaultProps,h),e.props=h),w){var x=new p(h,n),k=x.getChildContext();i(k)||(n=Object.assign({},n,k)),x.context=n,x._pendingSetState=!0,s(x.componentWillMount)&&x.componentWillMount();var b=x.render(h,e.context);return x._pendingSetState=!1,b?y(b,n,!0):""}return y(p(h,n),n,!0)}if(3970&l){var M,S="<"+p,C=t(p);if(!c(h))for(var I in h){var _=h[I];"dangerouslySetInnerHTML"===I?M=_.__html:"style"===I?S+=' style="'+v(h.style)+'"':"className"!==I||i(_)?o(_)?S+=" "+I+'="'+r(_)+'"':f(_)&&(S+=" "+I):S+=' class="'+r(_)+'"'}if(C)S+=">";else{if(S+=">",u(g))M&&(S+=M);else if(O(g))for(var N=0;N<g.length;N++){var P=g[N];u(P)||(S+=y(P,n,0===N))}else S+=o(g)?r(g):y(g,n,!0);C||(S+="</"+p+">")}return S}return 1&l?(a?"":"<!---->")+r(g):void d()}function g(e){return y(e,{},!0)}function w(e){return y(e,{},!0)}function x(e){if(o(e))return e;var t=[];for(var u in e){var s=e[u],a=l(s)&&!W[u]?"px":"";i(s)||t.push(n(u)+":"+r(s)+a+";")}return t.join()}function k(e){var n=[],t=e&&Object.keys(e)||[];return t.forEach(function(t,i){var u=e[t];switch(t){case"dangerouslySetInnerHTML":case"className":case"style":return;default:o(u)?n.push(r(t)+'="'+r(u)+'"'):f(u)&&n.push(r(t))}}),n}function b(e){return new U(e,!1)}function M(e){return new U(e,!0)}var S=/[A-Z]/g,C=/^ms-/,I={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},_="a runtime error occured! Use Inferno in development environment to find the error.",N="undefined"!=typeof window&&window.document,O=Array.isArray,P=(new Map,function(){this.listeners=[],this.fastUnmount=!0});P.prototype.addListener=function(e){this.listeners.push(e)},P.prototype.trigger=function(){for(var e=this,r=0;r<this.listeners.length;r++)e.listeners[r]()};var T="http://www.w3.org/1999/xlink",j="http://www.w3.org/XML/1998/namespace",E={},L={},A={},W={},D={},H={};h("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",A,T),h("xml:base,xml:lang,xml:space",A,j),h("volume,defaultValue,defaultChecked",E,!0),h("children,ref,key,selected,checked,value,multiple",D,!0),h("onClick,onMouseDown,onMouseUp,onMouseMove,onSubmit,onDblClick,onKeyDown,onKeyUp,onKeyPress",H,!0),h("muted,scoped,loop,open,checked,default,capture,disabled,readOnly,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate",L,!0),h("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",W,!0);var U=(new Map,new Map,new Map,new Map,new Map,N?document.body:null,function(e){function n(r,n){e.call(this),this.started=!1,this.initNode=r,this.staticMarkup=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype._read=function(){var e=this;this.started||(this.started=!0,Promise.resolve().then(function(){return e.renderNode(e.initNode,null,e.staticMarkup)}).then(function(){e.push(null)}).catch(function(r){e.emit("error",r)}))},n.prototype.renderNode=function(e,r,n){if(!u(e)){var t=e.flags;return 28&t?this.renderComponent(e,n,r,4&t):3970&t?this.renderElement(e,n,r):this.renderText(e,n,r)}},n.prototype.renderComponent=function(e,r,n,t){var o=this,u=e.type,s=e.props;if(!t)return this.renderNode(u(s),n,r);var a=new u(s),l=a.getChildContext();return i(l)||(n=Object.assign({},n,l)),a.context=n,a._pendingSetState=!0,Promise.resolve(a.componentWillMount()).then(function(){var e=a.render();return a._pendingSetState=!1,o.renderNode(e,n,r)})},n.prototype.renderChildren=function(e,n){var t=this;if(o(e))return this.push(r(e));if(e){var i=O(e);if(!i&&!u(e))return this.renderNode(e,n,!1);if(!i)throw new Error("invalid component");return e.reduce(function(e,i){return e.then(function(e){var s=o(i);return s?(e===!0&&t.push("<!---->"),s&&t.push(r(i)),!0):O(i)?(t.push("<!---->"),Promise.resolve(t.renderChildren(i)).then(function(){return t.push("<!--!-->"),!0})):u(i)?void 0:(1&i.flags&&(e&&t.push("<!---->"),e=!0),t.renderNode(i,n,!1).then(function(e){return!!(1&i.flags)}))})},Promise.resolve(!1))}},n.prototype.renderText=function(e,r,n){var t=this;return Promise.resolve().then(function(r){return t.push(e.children),r})},n.prototype.renderElement=function(e,n,o){var u=this,s=e.type,a=e.props,l=k(a),c="";if(a){var f=a.className;i(f)||l.push('class="'+r(f)+'"');var p=a.style;p&&l.push('style="'+x(p)+'"'),a.dangerouslySetInnerHTML&&(c=a.dangerouslySetInnerHTML.__html)}if(n&&l.push("data-infernoroot"),this.push("<"+s+(l.length>0?" "+l.join(" "):"")+">"),!t(s))return c?(this.push(c),void this.push("</"+s+">")):Promise.resolve(this.renderChildren(e.children,o)).then(function(){u.push("</"+s+">")})},n}(e.Readable)),q={renderToString:g,renderToStaticMarkup:w,streamAsString:b,streamAsStaticMarkup:M,RenderStream:U};return q});
