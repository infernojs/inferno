!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.InfernoRouter=e()}(this,function(){"use strict";function t(t){return t instanceof Array}function e(t){return s(t)||r(t)}function n(t){return r(t)||t===!1||i(t)||s(t)}function o(t){return"function"==typeof t}function r(t){return null===t}function i(t){return t===!0}function s(t){return void 0===t}function a(t){throw t||(t=R),new Error("Inferno Error: "+t)}function p(t,e,n){t.split(",").forEach(function(t){return e[t]=n})}function u(t,e,n,o,r){return{type:t,dom:null,hooks:o||null,instance:null,key:n,nodeType:M,props:e,ref:r||null}}function l(t,e,n,o,r,i){return{children:n,childrenType:i||T,dom:null,key:o,nodeType:j,props:e,ref:r||null,tag:t}}function c(t,e){return{children:t,childrenType:e||T,dom:null,nodeType:E,pointer:null}}function h(){return{dom:null,nodeType:I}}function d(t,e,n){var o=$.get(t);o||(o=[],$.set(t,o),requestAnimationFrame(function(){m(t,e,function(){for(var t=0;t<o.length;t++)o[t]()}),$.delete(t),t._processingSetState=!1})),n&&o.push(n)}function f(t,e,n){o(e)&&(e=e(t.state));for(var r in e)t._pendingState[r]=e[r];t._pendingSetState?(t.state=Object.assign({},t.state,t._pendingState),t._pendingState={}):t._processingSetState||n?d(t,!1,n):(t._pendingSetState=!0,t._processingSetState=!0,m(t,!1,n),t._processingSetState=!1)}function m(o,r,i){if((!o._deferSetState||r)&&!o._blockRender){o._pendingSetState=!1;var s=o._pendingState,a=o.state,p=Object.assign({},a,s),u=o.props,l=o.context;o._pendingState={};var d=o._updateComponent(a,p,u,u,l,r),f=!0;n(d)?d=h():t(d)?d=c(d,null):d===C&&(d=o._lastInput,f=!1);var m=o._lastInput,y=m.dom.parentNode;if(o._lastInput=d,f){var g=new U,_=o.getChildContext();_=e(_)?Object.assign({},l,o._childContext):Object.assign({},l,o._childContext,_),o._patch(m,d,y,g,_,o._isSVG,!1),g.trigger(),o.componentDidUpdate(u,a)}o._vComponent.dom=d.dom,o._componentToDOMNodeMap.set(o,d.dom),e(i)||i()}}function y(t,e,n){n=n||{},e=e||[];var o,r=n.strict,i=n.end!==!1,s=n.sensitive?"":"i",a=0,p=e.length,u=0,l=0;if(t instanceof RegExp){for(;o=K.exec(t.source);)e.push({name:l++,optional:!1,offset:o.index});return t}if(Array.isArray(t))return t=t.map(function(t){return y(t,e,n).source}),new RegExp("(?:"+t.join("|")+")",s);for(t=("^"+t+(r?"":"/"===t[t.length-1]?"?":"/?")).replace(/\/\(/g,"/(?:").replace(/([\/\.])/g,"\\$1").replace(/(\\\/)?(\\\.)?:(\w+)(\(.*?\))?(\*)?(\?)?/g,function(t,n,o,r,i,s,p,u){n=n||"",o=o||"",i=i||"([^\\/"+o+"]+?)",p=p||"",e.push({name:r,optional:!!p,offset:u+a});var l=""+(p?"":n)+"(?:"+o+(p?n:"")+i+(s?"((?:[\\/"+o+"].+?)?)":"")+")"+p;return a+=l.length-t.length,l}).replace(/\*/g,function(t,n){for(var o=e.length;o-- >p&&e[o].offset>n;)e[o].offset+=3;return"(.*)"});o=K.exec(t);){for(var c=0,h=o.index;"\\"===t.charAt(--h);)c++;c%2!==1&&((p+u===e.length||e[p+u].offset>o.index)&&e.splice(p+u,0,{name:l++,optional:!1,offset:o.index}),u++)}return t+=i?"$":"/"===t[t.length-1]?"":"(?=\\/|$)",new RegExp(t,s)}function g(t){return"string"!=typeof t?t:decodeURIComponent(t)}function _(t,e,n,o){var r=e+"|"+t,i=X.get(r);if(!i){var s=[];i={pattern:H(e,s,{end:t}),keys:s},X.set(r,i)}var a=i.pattern.exec(n);if(!a)return null;var p=a[0],u=Y;o&&Object.assign(u,o);for(var l=1;l<a.length;l+=1)u[i.keys[l-1].name]=g(a[l]);return{path:""===p?"/":p,params:u}}function v(t,e){var n=t.props||Y,o=e.props||Y,r=x(o.path)-x(n.path);return r||o.path&&n.path?o.path.length-n.path.length:0}function S(t){return t.replace(/(^\/+|\/+$)/g,"")}function x(t){return void 0===t&&(t=""),(S(t).match(/\/+/g)||"").length}function w(e,n,o){if(void 0===o&&(o=""),!e)return e;var r=b(e);r.sort(v);for(var i=0;i<r.length;i++){var s=t(r[i])?w(r[i],n,o):r[i],a=s.props.path||"/",p=(o+a).replace("//","/"),u=s.props.children,l=_(!u,p,n.replace("//","/"));if(l)return s.props.params=l.params,u&&(s.props.children=w(u,n,p)),s.instance?s.type(s.instance.props,s.instance.context):s}}function b(e){return t(e)?e:e?[e]:e}function k(t,e){var n=e.router,o=t.activeClassName,r=t.activeStyle,i=t.className,s=t.to,a={href:s};i&&(a.className=i),n.location.pathname===s&&(o&&(a.className=(i?i+" ":"")+o),r&&(a.style=Object.assign({},t.style,r))),a.onclick=function(e){0!==e.button||e.ctrlKey||e.altKey||(e.preventDefault(),t.onEnter?t.onEnter(t,function(t){n.push(s,e.target.textContent)}):n.push(s,e.target.textContent))};var p=l("a",a,t.children,null,null,null);return p}var C="$NO_OP",R="a runtime error occured! Use Inferno in development environment to find the error.",O="undefined"!=typeof window&&window.document,j=1,E=4,M=6,I=7,T=5,U=function(){this._listeners=[]};U.prototype.addListener=function(t){this._listeners.push(t)},U.prototype.trigger=function(){for(var t=this,e=0;e<this._listeners.length;e++)t._listeners[e]()};var W="http://www.w3.org/1999/xlink",D="http://www.w3.org/XML/1998/namespace",N={},L={},A={},G={};p("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",A,W),p("xml:base,xml:lang,xml:space",A,D),p("volume,value,defaultValue,defaultChecked",N,!0),p("muted,scoped,loop,open,checked,default,capture,disabled,selected,readonly,multiple,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate",L,!0),p("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",G,!0);var P=(new Map,new Map,new Map,O?document.body:null,"Inferno Error: Can only update a mounted or mounting component. This usually means you called setState() or forceUpdate() on an unmounted component. This is a no-op."),$=new Map,z=function(t,e){this.state={},this.refs={},this._processingSetState=!1,this._blockRender=!1,this._blockSetState=!1,this._deferSetState=!1,this._pendingSetState=!1,this._pendingState={},this._lastInput=null,this._vComponent=null,this._unmounted=!0,this._devToolsStatus=null,this._devToolsId=null,this._childContext=null,this._patch=null,this._isSVG=!1,this._componentToDOMNodeMap=null,this.props=t||{},this.context=e||{},this.componentDidMount||(this.componentDidMount=null)};z.prototype.render=function(t,e){},z.prototype.forceUpdate=function(t){if(this._unmounted)throw Error(P);m(this,!0,t)},z.prototype.setState=function(t,e){if(this._unmounted)throw Error(P);this._blockSetState===!1?f(this,t,e):a()},z.prototype.componentWillMount=function(){},z.prototype.componentWillUnmount=function(){},z.prototype.componentDidUpdate=function(t,e,n){},z.prototype.shouldComponentUpdate=function(t,e,n){return!0},z.prototype.componentWillReceiveProps=function(t,e){},z.prototype.componentWillUpdate=function(t,e,n){},z.prototype.getChildContext=function(){},z.prototype._updateComponent=function(t,n,o,r,i,s){if(this._unmounted===!0)throw new Error("You can't update an unmounted component!");if(!e(r)&&e(r.children)&&(r.children=o.children),o!==r||t!==n||s){o!==r&&(this._blockRender=!0,this.componentWillReceiveProps(r,i),this._blockRender=!1,this._pendingSetState&&(n=Object.assign({},n,this._pendingState),this._pendingSetState=!1,this._pendingState={}));var a=this.shouldComponentUpdate(r,n,i);if(a!==!1||s){this._blockSetState=!0,this.componentWillUpdate(r,n,i),this._blockSetState=!1,this.props=r,this.state=n,this.context=i,this.beforeRender&&this.beforeRender();var p=this.render(r,i);return this.afterRender&&this.afterRender(),p}}return C};var F={pending:"pending",fulfilled:"fulfilled",rejected:"rejected"},V=function(t){function e(e,n){t.call(this,e,n),this.state={async:null}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.async=function t(){var e=this,t=this.props.async;t&&(this.setState({async:{status:F.pending}}),t(this.props.params).then(function(t){e.setState({async:{status:F.fulfilled,value:t}})},this.reject).catch(this.reject))},e.prototype.onEnter=function t(){var e=this.props,t=e.onEnter;t&&t(this.props,this.context.router)},e.prototype.onLeave=function t(){var e=this.props,t=e.onLeave;t&&t(this.props,this.context.router)},e.prototype.reject=function(t){this.setState({async:{status:F.rejected,value:t}})},e.prototype.componentWillReceiveProps=function(){this.async(),this.onLeave()},e.prototype.componentWillMount=function(){this.async()},e.prototype.componentDidUpdate=function(){this.onEnter()},e.prototype.render=function(){var t=this.props,e=t.component,n=t.children,o=t.params;return u(e,{params:o,children:n,async:this.state.async})},e}(z),q=y,K=/\((?!\?)/g,H=q||pathToRegExp1,X=new Map,Y={},B=function(t){function e(e,n){t.call(this,e,n),this._didRoute=!1,this.router=e.history,this.state={url:e.url||this.router.location.pathname+this.router.location.search}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getChildContext=function(){return{router:this.router||{location:{pathname:this.props.url}}}},e.prototype.componentWillMount=function(){var t=this;this.router&&(this.unlisten=this.router.listen(function(e){t.routeTo(e.pathname)}))},e.prototype.componentWillUnmount=function(){this.unlisten&&this.unlisten()},e.prototype.routeTo=function(t){return this._didRoute=!1,this.setState({url:t}),this._didRoute},e.prototype.render=function(){var t=this.props,e=t.matched,n=t.children,o=t.url;if(e)return e;var r=b(n);return w(r,o||this.state.url,"")},e}(z),J={Route:V,Router:B,Link:k,getRoutes:w};return J});
