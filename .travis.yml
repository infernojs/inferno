language: node_js

node_js:
- '6'

cache:
  directories:
  - node_modules
  - fixtures/browser/node_modules
  - fixtures/packaging/node_modules

notifications:
  email:
    on_success: change
    on_failure: always

sudo: required
dist: trusty

addons:
  chrome: stable
  firefox: latest

before_install:
- npm install -g npm@5

before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start

jobs:
  include:
  - script: npm run lint
  - script:
    - npm run test:coverage
    - npm run coveralls
  - script: npm run test:browser
  - stage: Build
    script:
    - npm run build
    - npm run test:package
